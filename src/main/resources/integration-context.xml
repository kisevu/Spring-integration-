<?xml version="1.0" encoding="UTF-8" ?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:int="http://www.springframework.org/schema/integration"
       xmlns:int-jms="http://www.springframework.org/schema/integration/jms"
       xsi:schemaLocation="
           http://www.springframework.org/schema/beans
           https://www.springframework.org/schema/beans/spring-beans.xsd
           http://www.springframework.org/schema/integration
           https://www.springframework.org/schema/integration/spring-integration.xsd
           http://www.springframework.org/schema/integration/jms
           https://www.springframework.org/schema/integration/jms/spring-integration-jms.xsd">

     <bean id="connectionFactory" class="org.springframework.jms.connection.CachingConnectionFactory">
         <property name="targetConnectionFactory">
             <bean class="org.apache.activemq.ActiveMQConnectionFactory">
                 <property name="brokerURL" value="tcp://localhost:61616"/>
             </bean>
         </property>
     </bean>
    <bean id="queue" class="org.apache.activemq.command.ActiveMQQueue">
        <constructor-arg value="sample.queue"> </constructor-arg>
    </bean>
    <int-jms:outbound-channel-adapter
            connection-factory="connectionFactory"
            channel="outboundChannel"
            destination="queue"/>

    <int:object-to-string-transformer
            input-channel="inboundChannel"
            output-channel="outboundChannel">
    </int:object-to-string-transformer>

    <int:gateway service-interface="com.ameda.kevin.integration_spring.PersonGateway"
                 default-request-channel="inboundChannel">
    </int:gateway>


    <int:channel id="jmsChannel"/>
    <int:channel id="inboundChannel"/>
    <int:channel id="outboundChannel"/>


    <bean id="printerService" class="com.ameda.kevin.integration_spring.PrintService"/>
    <int:service-activator ref="printerService" method="print"  input-channel="jmsChannel"/>
</beans>

<!--
* Integration with JMS (Java Message Service) JMS Outbound Channel Adapter
*******************************************************
*  JMS is an API that detects how applications communicate.
*  The API contains a list of interfaces which a java application can use to create, send, receive or read
messages.
* JMS provides for loose coupling between systems and creates reliable transport between the nodes.
* JMS Channel adapters are used to communicate with activemq server.
* JMS Outbound channel Adapter to send a message to jms server
Process of how everything is working
********************************************
* In Main application, we are invoking the save method on the gateway passing in a Person.
In xml-config, I've set up a gateway to accept the person object by making it the payload of the message
and sending it to the inbound channel.Inbound channel is connected to "object-to_string transformer" which will
in turn invoke the toString on person object.This is then made to be the payload which is entirely sent to the outboundchannel.
My outbound channel is then connected to the Outbound channel Adapter.
The Outbound channel Adapter then sends the message to destination which is the queue. The connection to the queue is
seamless because we have a configuration in place which tells it how to connect.
-->
